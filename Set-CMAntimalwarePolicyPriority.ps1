function Set-CMAntimalwarePolicyPriority {
    <#
    .SYNOPSIS
        Move a MEMCM Antimalware policy to the specified priority
    .DESCRIPTION
        Becuase the GUI does not allow you to move more than one step at a time,
        this PowerShell function can be used to set an Antimalware policy to a speicific
        priority without having to click increase, or decrease over and over
    .PARAMETER Name
        The name of the Antimalware Policy to increase or decrease the priority of
    .PARAMETER Priority
        The desired priority to set the Antimalware Policy to
    .EXAMPLE
        PS C:\> Set-CMAntimalwarePolicyPriority -Name 'AVPolicy1' -Priority 3
            Will move the priority of the AVPolicy1 up, or down, until it reaches priority 3
    .NOTES
        FileName:    Set-CMAntimalwarePolicyPriority.ps1
        Author:      Cody Mathis
        Contact:     @CodyMathis123
        Created:     2020-07-07
        Updated:     2020-07-07
    #>
    [CmdletBinding(SupportsShouldProcess = $true)]
    param (
        [Parameter(Mandatory = $true)]
        [string]$Name,
        [Parameter(Mandatory = $true)]
        [int]$Priority
    )
    $result = $false

    $Policy = Get-CMAntimalwarePolicy -Name $Name
    if ($null -eq $Policy) {
        Write-Warning "No AntiMalware policy found with [Name: $Name]"
        return $false
    }
    $BeginningPriority = $Policy.Priority

    if ($BeginningPriority -eq $Priority) {
        Write-Verbose "Policy [Name: $Name] found with [Priority: $BeginningPriority] already set"
        return $true
    }
    else {
        Write-Verbose "Policy [Name: $Name] found with [Priority: $BeginningPriority] - will increase or decrease as needed"

        switch ($Priority -gt $BeginningPriority) {
            $true {
                Write-Verbose "Will Decrease policy priority until it reaches $Priority"
                if ($PSCmdlet.ShouldProcess("[PolicyName: $Name] [DesiredPriority: $Priority] [Action: Decrease]", "Set-CMAntimalwarePolicyPriority")) {

                    Do {
                        $Policy | Set-CMAntimalwarePolicy -Priority Decrease
                    }
                    until ((Get-CMAntimalwarePolicy -Name $Name).Priority -eq $Priority)
                }
            }
            $false {
                Write-Verbose "Will Increase policy priority until it reaches $Priority"
                if ($PSCmdlet.ShouldProcess("[PolicyName: $Name] [DesiredPriority: $Priority] [Action: Increase]", "Set-CMAntimalwarePolicyPriority")) {

                    Do {
                        $Policy | Set-CMAntimalwarePolicy -Priority Increase
                    }
                    until ((Get-CMAntimalwarePolicy -Name $Name).Priority -eq $Priority)
                }
            }
        }

        $EndPriority = (Get-CMAntimalwarePolicy -Name $Name).Priority
        if ($EndPriority -eq $Priority) {
            return $true
        }
        else {
            return $false
        }
    }
}